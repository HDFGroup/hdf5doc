<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="file_driver_files/filelist.xml">
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="date"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="country-region"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>slu</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>slu</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>13950</o:TotalTime>
  <o:Created>2005-05-09T15:38:00Z</o:Created>
  <o:LastSaved>2005-05-09T15:38:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1662</o:Words>
  <o:Characters>9475</o:Characters>
  <o:Company>NCSA</o:Company>
  <o:Lines>78</o:Lines>
  <o:Paragraphs>22</o:Paragraphs>
  <o:CharactersWithSpaces>11115</o:CharactersWithSpaces>
  <o:Version>10.6714</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
p.MsoDate, li.MsoDate, div.MsoDate
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-even-footer:url("file_driver_files/header.htm") ef1;
	mso-footer:url("file_driver_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:219093648;
	mso-list-type:hybrid;
	mso-list-template-ids:1493230166 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:533662355;
	mso-list-type:hybrid;
	mso-list-template-ids:1168827560 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:708067523;
	mso-list-type:hybrid;
	mso-list-template-ids:1214796214 1284547292 67698703 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-number-format:roman-upper;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.5in;}
@list l2:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3
	{mso-list-id:964966567;
	mso-list-type:hybrid;
	mso-list-template-ids:317086104 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span><b
style='mso-bidi-font-weight:normal'><span style='font-size:16.0pt'>A Proposal
of File Driver Change<o:p></o:p></span></b></p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span><span
style='mso-tab-count:1'>            </span><span class=SpellE><b
style='mso-bidi-font-weight:normal'>Quincey</b></span><b style='mso-bidi-font-weight:
normal'> <span class=SpellE>Koziol</span> and Raymond Lu<o:p></o:p></b></p>

<p class=MsoNormal><span style='mso-tab-count:4'>                                                </span><span
style='mso-tab-count:1'>            </span><st1:date Month="10" Day="22"
Year="2004">Oct 22, 2004</st1:date></p>

<p class=MsoNormal><span style='mso-tab-count:4'>                                                </span><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span>Revised
on <st1:date Year="2005" Day="9" Month="5">May 9, 2005</st1:date></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>In this document, we discuss the current library behavior
regarding file driver and a proposed change for the internal library design.</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.5in;mso-list:l2 level1 lfo1;
tab-stops:list .75in'><![if !supportLists]><b style='mso-bidi-font-weight:normal'><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>I.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style='mso-bidi-font-weight:normal'>Current
Library Behavior and Design<o:p></o:p></b></p>

<p class=MsoNormal style='margin-left:.25in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>When users create and close a HDF5 file with a certain file
driver, our library of current design does not save any information about the
file driver (the multi driver is an exception).<span style='mso-spacerun:yes'> 
</span>When users try to re-open the file, our current library asks users to
pick the right file driver.<span style='mso-spacerun:yes'>  </span>For family,
multi, or split driver, if the driver is incorrect, the library will return
failure in an unpredictable way.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For example, for the family driver, the library does not have
the member file size saved anywhere.<span style='mso-spacerun:yes'>  </span>The
family driver and the member file size are set through function <span
style='font-size:10.0pt;font-family:"Courier New"'>H5Pset_fapl_family</span>.<span
style='mso-spacerun:yes'>  </span>Our <i style='mso-bidi-font-style:normal'>User’s
Guide</i> says, “<span class=GramE><i style='mso-bidi-font-style:normal'>the</i></span><i
style='mso-bidi-font-style:normal'> member size is only used when creating a
new file or truncating an existing file; otherwise the member size comes from
the size of the first member of the family file being opened</i>”.<span
style='mso-spacerun:yes'>  </span>If a user wants to open a family file, he or
she has to open it with the family driver and correct family name template
assuming he knows the file is a family file.<span style='mso-spacerun:yes'> 
</span>The original member file size has been lost.<span
style='mso-spacerun:yes'>  </span>So the library sets the member file size to
be the current size of the first member file.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Below is part of code which opens a family file named “<span
style='font-size:10.0pt;font-family:"Courier New"'>family%05d.h5</span>” with
member file size of “<span style='font-size:10.0pt;font-family:"Courier New"'>FAMILY_SIZE</span>”.
</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'>/* <span class=GramE>Create</span> a file access
property list */<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>(<span class=SpellE>fapl</span>=H5Pcreate(H5P_FILE_ACCESS))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>      </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'>/* Set family driver; set member file size to
FAMILY_SIZE */<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>H5Pset_fapl_family(<span
class=SpellE>fapl</span>, (<span class=SpellE>hsize_t</span>)FAMILY_SIZE, <span
class=SpellE>fapl</span>)&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span>/* Open family file with family name
template */<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family%05d.h5”, H5F_ACC_RDWR, <span
class=SpellE>fapl</span>))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The library will replace the integer format <span
class=SpellE>specifier</span> in the name template “<span style='font-size:
10.0pt;font-family:"Courier New"'>family%05d.h5</span>” with member number
starting from 0, “<span style='font-size:10.0pt;font-family:"Courier New"'>family00000.h5,
family00001.h5, family00002.h5 …</span>”</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If a user does not know the file is a family file and tries
to open the first member file family00000.h5 with default file access property
list, a failure will happen,</p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span>/* Open a family file as normal HDF5 file
*/<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family00000.h5”, H5F_ACC_RDWR,
H5P_DEFAULT))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>So we can list the library behavior for family files in the
following table,</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext 1.0pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .75pt solid windowtext;mso-border-insidev:.75pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td width=99 valign=top style='width:74.45pt;border:solid windowtext 1.0pt;
  mso-border-top-alt:1.0pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:
  .75pt;mso-border-right-alt:.75pt;mso-border-color-alt:windowtext;mso-border-style-alt:
  solid;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>The way to open family file</p>
  </td>
  <td width=99 valign=top style='width:73.9pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with default property list and 1<sup>st</sup> member
  file name</p>
  </td>
  <td width=117 valign=top style='width:87.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with default property list and 1<sup>st</sup> member
  name, but there’s only 1 member file</p>
  </td>
  <td width=99 valign=top style='width:74.15pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with default property list and correct file name
  template</p>
  </td>
  <td width=99 valign=top style='width:74.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with family driver and correct name template</p>
  </td>
  <td width=78 valign=top style='width:58.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-top-alt:
  1.0pt;mso-border-left-alt:.75pt;mso-border-bottom-alt:.75pt;mso-border-right-alt:
  1.0pt;mso-border-color-alt:windowtext;mso-border-style-alt:solid;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with family driver but wrong file name template</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td width=99 valign=top style='width:74.45pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;mso-border-top-alt:
  .75pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:1.0pt;mso-border-right-alt:
  .75pt;mso-border-color-alt:windowtext;mso-border-style-alt:solid;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Library behavior</p>
  </td>
  <td width=99 valign=top style='width:73.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail</p>
  </td>
  <td width=117 valign=top style='width:87.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=GramE>Succeed(</span>library treats this file
  not as family file).</p>
  </td>
  <td width=99 valign=top style='width:74.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail</p>
  </td>
  <td width=99 valign=top style='width:74.2pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Succeed</p>
  </td>
  <td width=78 valign=top style='width:58.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For all the file drivers we have, we are only concerned with
the family, multi, and split drivers because these three drivers make the file
physically different.<span style='mso-spacerun:yes'>  </span>They break up a
single output file into multiple files.<span style='mso-spacerun:yes'>  </span>Whether
users choose the right driver is critical.<span style='mso-spacerun:yes'> 
</span>For the other drivers, like the sec2, stream, core, MPIO, SRB, and GASS,
what driver to use would not affect the output file physically.<span
style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>In the HDF5 file <span class=SpellE>superblock</span>, there
is a space reserved for driver information.<span style='mso-spacerun:yes'> 
</span>It has 3 fields, driver information size, driver name, and driver
information.<span style='mso-spacerun:yes'>  </span>Each file driver can have
its own encoding and decoding functions to save its information in this
space.<span style='mso-spacerun:yes'>  </span>This space is optional.<span
style='mso-spacerun:yes'>  </span>Currently, only multi driver stores its
information in the <span class=SpellE>superblock</span>.</p>

<p class=MsoNormal style='margin-left:.25in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.5in;mso-list:l2 level1 lfo1;
tab-stops:list .75in'><![if !supportLists]><b style='mso-bidi-font-weight:normal'><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>II.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style='mso-bidi-font-weight:normal'>Use
Case<o:p></o:p></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal>For the user Dan <span class=SpellE>Anov</span> from <st1:country-region><st1:place>Denmark</st1:place></st1:country-region>,
he has multiple programs from different kinds of platforms accessing data
files.<span style='mso-spacerun:yes'>  </span>The datasets are extendable.<span
style='mso-spacerun:yes'>  </span>In order to support every day backup and
Windows system, he chooses family file driver to break down his files, with
each member smaller than 2GB.<span style='mso-spacerun:yes'>  </span>Without
saving original family member size in file, some programs may easily extend
files bigger than 2GB.<span style='mso-spacerun:yes'>  </span>Because there are
multiple users accessing his files, some users, who have not realized they are
dealing with family files, have tried to open certain member files with default
or some other file drivers and corrupted the files. <span
style='mso-spacerun:yes'>   </span><o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.5in;mso-list:l2 level1 lfo1;
tab-stops:list .75in'><![if !supportLists]><b style='mso-bidi-font-weight:normal'><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>III.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style='mso-bidi-font-weight:normal'>Suggestion
of Changing the Design of File Driver<o:p></o:p></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For each of the file driver we are concerned, we can save
its information necessary for file re-opening in the driver information block of
the file’s <span class=SpellE>superblock</span>.<span
style='mso-spacerun:yes'>  </span>In this way, if a user opens a file with a
certain file driver, our library will check if the correct driver has been
used.<span style='mso-spacerun:yes'>  </span>If not, a failure will return with
an error message indicating the correct driver.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For family driver, the size for member files used to create can
be also stored in the driver information block.<span style='mso-spacerun:yes'> 
</span>The library will also check if the user has passed in correct member
file size.<span style='mso-spacerun:yes'>  </span>If not, a failure will return
with an error message indicating the correct size.<span
style='mso-spacerun:yes'>  </span>If the user does not know the right size, he or
she can use the default value which is 0.<span style='mso-spacerun:yes'> 
</span>The name template is also saved for possible future use.<span
style='mso-spacerun:yes'>  </span>We also add a version number field in case we
may want to save some other information in the <span class=SpellE>superblock</span>
in the future.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>If for any reason, the actual member size has been modified
(like using the <span class=GramE>Unix</span> tool “cat” to concatenate) and
file cannot be opened.<span style='mso-spacerun:yes'>  </span>Users can use the
tool h5repart to restore the original size.<span style='mso-spacerun:yes'> 
</span>The original size can found in the error message.<span
style='mso-spacerun:yes'>  </span>If h5repart is used, we can let it modify the
member size in the <span class=SpellE>superblock</span>.<span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal>Still, the drivers we discuss here are family, multi, and
split.<span style='mso-spacerun:yes'>  </span>If a user adds his own driver to
the library, because we do not know if it changes the file physically, he has
to modify this part of the library himself to enable this feature. <span
style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Let us still use family file driver as an example.<span
style='mso-spacerun:yes'>  </span>Not knowing the file driver, a user picks
default file access property list to open the first member file,<span
style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family00000.h5”, H5F_ACC_RDWR,
H5P_DEFAULT))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Our library will try to open this file “<span
style='font-size:10.0pt;font-family:"Courier New"'>family00000.h5</span>” with
the default sec2 driver.<span style='mso-spacerun:yes'>  </span>Once the
library finds out from the <span class=SpellE>superblock</span> the file is a
family file, it returns failure with a message indicating family driver should
be used.<span style='mso-spacerun:yes'>  </span>After receive this error
message, </p>

<p class=MsoNormal><span class=GramE>the</span> user can use the correct family
name template and property list to open the file.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>We can redraw the table of library behavior for family
driver as this,</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext 1.0pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .75pt solid windowtext;mso-border-insidev:.75pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td width=79 valign=top style='width:59.45pt;border:solid windowtext 1.0pt;
  mso-border-top-alt:1.0pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:
  .75pt;mso-border-right-alt:.75pt;mso-border-color-alt:windowtext;mso-border-style-alt:
  solid;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>The way to open family file</p>
  </td>
  <td width=86 valign=top style='width:64.35pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with default property list and 1<sup>st</sup> member
  file name</p>
  </td>
  <td width=86 valign=top style='width:64.35pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with default property list and 1<sup>st</sup> member
  name, but there’s only 1 member file</p>
  </td>
  <td width=86 valign=top style='width:64.4pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with default property list and correct file name
  template</p>
  </td>
  <td width=79 valign=top style='width:59.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with family driver and correct name template</p>
  </td>
  <td width=72 valign=top style='width:53.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with family driver and wrong file size</p>
  </td>
  <td width=72 valign=top style='width:.75in;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-top-alt:
  1.0pt;mso-border-left-alt:.75pt;mso-border-bottom-alt:.75pt;mso-border-right-alt:
  1.0pt;mso-border-color-alt:windowtext;mso-border-style-alt:solid;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with family driver but wrong file name template</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td width=79 valign=top style='width:59.45pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;mso-border-top-alt:
  .75pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:1.0pt;mso-border-right-alt:
  .75pt;mso-border-color-alt:windowtext;mso-border-style-alt:solid;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Library behavior</p>
  </td>
  <td width=86 valign=top style='width:64.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail with error message indicating family driver.</p>
  </td>
  <td width=86 valign=top style='width:64.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail with error message indicating family driver.</p>
  </td>
  <td width=86 valign=top style='width:64.4pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail with error message indicating family driver.</p>
  </td>
  <td width=79 valign=top style='width:59.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Succeed</p>
  </td>
  <td width=72 valign=top style='width:53.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail with error message indicating wrong size</p>
  </td>
  <td width=72 valign=top style='width:.75in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail with error message </p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For each of the cases in the table above, we give an
example.<span style='mso-spacerun:yes'>  </span>Let the name template be <span
style='font-size:10.0pt;font-family:"Courier New"'>family%05d.h5</span> and
member file size <span class=GramE>be</span> <span style='font-size:10.0pt;
font-family:"Courier New"'>1024</span> bytes.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo4;tab-stops:list .5in'>Open
     with default property list and first member file name:</li>
</ol>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family00000.h5”, H5F_ACC_RDWR, H5P_DEFAULT))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Fail with
error message indicating family driver should be used.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ol style='margin-top:0in' start=2 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo4;tab-stops:list .5in'>Open
     with default property list and first member name but there is only one
     member file:</li>
</ol>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>Same as the example above</span>.</span></p>

<p class=MsoNormal style='margin-left:.25in'><o:p>&nbsp;</o:p></p>

<ol style='margin-top:0in' start=3 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo4;tab-stops:list .5in'>Open
     with default property list and correct file name template:</li>
</ol>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family%05d.h5”, H5F_ACC_RDWR, H5P_DEFAULT))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Fail with
error message indicating family driver should be used.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ol style='margin-top:0in' start=4 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo4;tab-stops:list .5in'>Open
     with family driver and correct name template:</li>
</ol>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>(<span class=SpellE>fapl</span>=H5Pcreate(H5P_FILE_ACCESS))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>      </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>H5Pset_fapl_family(<span
class=SpellE>fapl</span>, (<span class=SpellE>hsize_t</span>)1024, <span
class=SpellE>fapl</span>)&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family%05d.h5”, H5F_ACC_RDWR, <span
class=SpellE>fapl</span>))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Succeed.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ol style='margin-top:0in' start=5 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo4;tab-stops:list .5in'>Open
     with family driver and wrong file size:</li>
</ol>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>(<span class=SpellE>fapl</span>=H5Pcreate(H5P_FILE_ACCESS))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>      </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>H5Pset_fapl_family(<span
class=SpellE>fapl</span>, 2048, <span class=SpellE>fapl</span>)&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family%05d.h5”, H5F_ACC_RDWR, <span
class=SpellE>fapl</span>))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:.25in'><span style='mso-tab-count:1'>      </span>Fail
with error message indicating correct file size.</p>

<p class=MsoNormal style='margin-left:.25in'><o:p>&nbsp;</o:p></p>

<ol style='margin-top:0in' start=6 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo4;tab-stops:list .5in'>Open
     with family driver and wrong name template:</li>
</ol>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>(<span class=SpellE>fapl</span>=H5Pcreate(H5P_FILE_ACCESS))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>      </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:.5in'><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New"'>if(</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'>H5Pset_fapl_family(<span
class=SpellE>fapl</span>, (<span class=SpellE>hsize_t</span>)1024, <span
class=SpellE>fapl</span>)&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span><span
class=SpellE><span class=GramE>goto</span></span> error;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
class=GramE>if(</span>(file= H5Fopen(“family%d.h5”, H5F_ACC_RDWR, <span
class=SpellE>fapl</span>))&lt;0)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in'><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>      </span><span class=SpellE><span class=GramE>goto</span></span>
error;<o:p></o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>            </span></b>Fail with error message.<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.5in;mso-list:l2 level1 lfo1;
tab-stops:list .75in'><![if !supportLists]><b style='mso-bidi-font-weight:normal'><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>IV.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style='mso-bidi-font-weight:normal'>Backward
Compatibility<o:p></o:p></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal>This suggested change is only for Release 1.8, or even a
later release.<span style='mso-spacerun:yes'>  </span>In this section, we
simply assume it will be in Release 1.8.<span style='mso-spacerun:yes'> 
</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>There’ll be no API change involved.<span
style='mso-spacerun:yes'>  </span>But we’ll have issues of backward
compatibility with earlier release.<span style='mso-spacerun:yes'>  </span>The
library’s behavior may be slightly different.<span style='mso-spacerun:yes'> 
</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The table below shows the compatibility between Release 1.6
and 1.8 for all three drivers, family, <span class=GramE>multi</span>,
split.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext 1.0pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .75pt solid windowtext;mso-border-insidev:.75pt solid windowtext'>
 <tr style='mso-yfti-irow:0'>
  <td width=118 valign=top style='width:88.55pt;border:solid windowtext 1.0pt;
  mso-border-top-alt:1.0pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:
  .75pt;mso-border-right-alt:.75pt;mso-border-color-alt:windowtext;mso-border-style-alt:
  solid;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><o:p>&nbsp;</o:p></p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with v1.6 using default property list</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with v1.6 using correct driver and name template</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-top-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with v1.8 using default property list</p>
  </td>
  <td width=118 valign=top style='width:88.6pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;mso-border-top-alt:
  1.0pt;mso-border-left-alt:.75pt;mso-border-bottom-alt:.75pt;mso-border-right-alt:
  1.0pt;mso-border-color-alt:windowtext;mso-border-style-alt:solid;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open with v1.8 using correct driver and name template</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=118 valign=top style='width:88.55pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;mso-border-alt:
  solid windowtext .75pt;mso-border-left-alt:solid windowtext 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>File created with v1.6</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail in unpredictable way</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Succeed</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail in unpredictable way</p>
  </td>
  <td width=118 valign=top style='width:88.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-right-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Succeed</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td width=118 valign=top style='width:88.55pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;mso-border-top-alt:
  .75pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:1.0pt;mso-border-right-alt:
  .75pt;mso-border-color-alt:windowtext;mso-border-style-alt:solid;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>File created with v1.8</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail in unpredictable way</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Succeed</p>
  </td>
  <td width=118 valign=top style='width:88.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  mso-border-alt:solid windowtext .75pt;mso-border-bottom-alt:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Fail with error message<o:p></o:p></p>
  </td>
  <td width=118 valign=top style='width:88.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Succeed</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>We still use family driver as an example.<span
style='mso-spacerun:yes'>  </span>For the older versions of the library without
the change, it will return a failure if a user tries to open a family file with
the default file access property list.<span style='mso-spacerun:yes'> 
</span>For the new version of the library with the change, it will also return
a failure if a user tries to open a family file created with older
library.<span style='mso-spacerun:yes'>  </span>That is because there is no
driver information in the <span class=SpellE>superblock</span>.<span
style='mso-spacerun:yes'>     </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>However, the difference will happen when the user opens the
file successfully with family driver.<span style='mso-spacerun:yes'> 
</span>For the older library, the original member file size has been lost while
for the new library, that size is stored and retrieved from the <span
class=SpellE>superblock</span>.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.5in;mso-list:l2 level1 lfo1;
tab-stops:list .75in'><![if !supportLists]><b style='mso-bidi-font-weight:normal'><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>V.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style='mso-bidi-font-weight:normal'>Difference
Between This and the Last Proposals<o:p></o:p></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal>In the last document, we proposed to save the driver <span
class=GramE>name,</span> the file name template and member file size in the <span
class=SpellE>superblock</span> for the family driver.<span
style='mso-spacerun:yes'>  </span>The library would be able to choose the right
<span class=GramE>driver,</span> name template and the member file size if the
user has not done so.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>To simply the design and avoid the drawbacks of the last
design, we decided to simply save the driver name and the member file
size.<span style='mso-spacerun:yes'>  </span>The name template is also saved
but not used at this stage.<span style='mso-spacerun:yes'>  </span>Once the
library finds out the driver or the member file size is wrong,</p>

<p class=MsoNormal><span class=GramE>it</span> simply returns failure with an
error message.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.5in;mso-list:l2 level1 lfo1;
tab-stops:list .75in'><![if !supportLists]><b style='mso-bidi-font-weight:normal'><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>VI.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style='mso-bidi-font-weight:normal'>Future
Features <o:p></o:p></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>In the future, depending on user’s request, we can provide
some flexibility to users, like the option of forcing to open files even though
the member file size or the file name template is wrong.<span
style='mso-spacerun:yes'>  </span>This can be done through an extra parameter
in the property list function to set family driver.</p>

</div>

</body>

</html>
