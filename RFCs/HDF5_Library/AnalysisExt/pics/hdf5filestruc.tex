\tikzstyle{textBox}    = [rectangle, text centered, font=\small \bfseries]
\tikzstyle{appBox}     = [draw, rectangle, rounded corners, fill=white, dashed, very thick]
\tikzstyle{fileBox}    = [draw, rectangle, fill=white, drop shadow={opacity=0.25}]
\tikzstyle{headerBox}  = [draw, rectangle, fill=rulecolor, font=\footnotesize]
\tikzstyle{dataBox}    = [draw, rectangle, thick, fill=white, pattern color=rulecolor, pattern=dots, font=\small]
\tikzstyle{cacheBox}   = [draw, rectangle, thick, fill=black!10, drop shadow={opacity=0.25}]
\tikzstyle{cacheBoxes} = [draw, tape, tape bend top=none, fill=rulecolor, double copy shadow]

%\tikzstyle{trans} = [->, >=stealth, thick, text centered, font=\footnotesize]
\tikzstyle{message} = [draw=blue, ->, very thick, shorten <=2pt, shorten >=2pt, 
  text centered, text width=2.5cm, font=\footnotesize]

\begin{tikzpicture}

\node[appBox, minimum height=4cm, minimum width=14cm] (app) {};
\node[textBox, minimum height=1cm, minimum width=2cm, below left=2mm of app.north east] (apptitle) {Application memory};
\node[cacheBox, minimum height=3.6cm, minimum width=6.4cm, right=2mm of app.west] (cache) {};
\node[rectangle, minimum height=3.6cm, minimum width=2.9cm, right=2mm of cache.west] (cachecol1) {};
\node[rectangle, minimum height=3.6cm, minimum width=2.9cm, right=2mm of cachecol1.east] (cachecol2) {};
\node[headerBox, minimum width=2.5cm, minimum height=0.7cm, below=1.7mm of cachecol1.north] (cache1) {Dataset header};
\node[headerBox, minimum width=2.5cm, below=-1pt of cache1] (cache2) {\dots};
\node[headerBox, minimum width=2.5cm, below=-1pt of cache2] (cache3) {Datatype};
\node[headerBox, minimum width=2.5cm, below=-1pt of cache3] (cache4) {Dataspace};
\node[headerBox, minimum width=2.5cm, below=-1pt of cache4] (cache5) {\dots};
\node[headerBox, minimum width=2.5cm, below=-1pt of cache5] (cache6) {Attributes};
\node[headerBox, minimum width=2.5cm, below=-1pt of cache6] (cache7) {\dots};

\node[textBox, minimum height=1cm, minimum width=2cm, below=1mm of cachecol2.north] (cachetitle) {Metadata cache};
\node[cacheBoxes, below=1.5cm of cachecol2.north, minimum width=2cm, minimum height=1cm] () {};

\node[fileBox, minimum height=1cm, minimum width=14cm, below=5mm of app] (file) {};
\node[textBox, minimum height=1cm, minimum width=2cm, right=4mm of file.west] (filetitle) {File};
\node[headerBox, thick, minimum height=1cm, minimum width=1cm, right=1.5cm of filetitle] (fileheader) {};
\node[dataBox, minimum height=1cm, minimum width=5cm, right=3cm of fileheader] (filedata) {Dataset data};

\node[rectangle, fill=white, minimum height=1cm, minimum width=5cm, above=2cm of filedata, drop shadow={opacity=0.25}] () {};
\node[dataBox, minimum height=1cm, minimum width=5cm, above=2cm of filedata] (appdata) {Dataset data};

\draw[message] (cache7.east) -| (fileheader.north);
\draw[message] (appdata.south west) -- (filedata.north west);
\draw[message] (appdata.south east) -- (filedata.north east);

\end{tikzpicture}
